{% extends "memories/base.html" %}
{% block title %}Muro - {{ evento.nombre }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <h3 class="mb-1 text-white">ðŸ§± Muro de fotos</h3>
        <div class="text-white">{{ evento.nombre }}</div>
    </div>
    <div class="d-flex gap-2">
        <a class="btn btn-primary"
            href="{% url 'subir_fotos' evento.token %}{% if momento_seleccionado %}?momento={{ momento_seleccionado.id }}{% endif %}">
            ðŸ“¸ Subir
        </a>
        <a class="btn btn-outline-light" href="{% url 'evento_home' evento.token %}">Inicio</a>
    </div>
</div>

<div class="card card-soft p-3 mb-3">
    <div class="fw-semibold mb-2">Filtrar por momento</div>
    <div class="d-flex flex-wrap gap-2">
        <a class="btn btn-sm {% if not momento_seleccionado %}btn-dark{% else %}btn-outline-dark{% endif %} chip"
            href="{% url 'muro' evento.token %}">Todo</a>

        {% for m in momentos %}
        <a class="btn btn-sm {% if momento_seleccionado and m.id == momento_seleccionado.id %}btn-dark{% else %}btn-outline-dark{% endif %} chip"
            href="{% url 'muro' evento.token %}?momento={{ m.id }}">
            {{ m.emoji }} {{ m.nombre }}
        </a>
        {% endfor %}
    </div>
</div>

{% if fotos %}
<div class="masonry">
    {% for f in fotos %}
    <div class="masonry-item">
        <a href="{{ f.imagen.url }}" target="_blank" style="text-decoration:none;">
            <img src="{{ f.imagen.url }}" alt="Foto">
        </a>
        {% if f.nombre_invitado or f.mensaje %}
        <div class="mt-2 px-1">
            <div class="small text-muted">{{ f.momento.emoji }} {{ f.momento.nombre }}</div>
            {% if f.mensaje %}
            <div class="small">{{ f.mensaje }}</div>
            {% endif %}
            {% if f.nombre_invitado %}
            <div class="small text-muted">â€” {{ f.nombre_invitado }}</div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    AÃºn no hay fotos. Â¡SÃ© el primero en subir! ðŸ“¸
</div>
{% endif %}
{% endblock %}